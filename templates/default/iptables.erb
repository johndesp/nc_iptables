# Generated by Chef - do not modify
*filter
:INPUT ACCEPT [0:0]
:FORWARD ACCEPT [0:0]
:OUTPUT ACCEPT [0:0]
# Allow any connection back that we establish
-A INPUT -m limit --limit 5/min -j LOG --log-prefix "Any Connection: " --log-level 7
-A INPUT -m conntrack --ctstate RELATED,ESTABLISHED -j ACCEPT 

# Chef defined firewall rules
<%- @input.sort { |a, b| a[1][:weight] <=> b[1][:weight] }.each do |name, rule_data| -%>
# Name: <%= name %>
<%= rule_data[:log] %>
<%- rule_data[:rule].each do |rule| -%>
<%= rule %>
<%- end -%>
<%- end -%>

# Drop all connections we didn't specify a rule for
-A INPUT -m limit --limit 5/min -j LOG --log-prefix "Any connection: " --log-level 7
-A INPUT -j DROP

# We aren't a router
-A FORWARD -m limit --limit 5/min -j LOG --log-prefix "Not Router: " --log-level 7
-A FORWARD -j DROP

# We have no filter on outbound traffic for convenience of app dev

COMMIT
